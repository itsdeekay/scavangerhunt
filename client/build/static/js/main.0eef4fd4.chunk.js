(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{126:function(e,t,n){},127:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(29),r=n.n(c),s=n(5),o=n(22),i=n(65),l=n(68),u="CREATE",d="UPDATE",b="FETCH_ALL",j="AUTH",p="LOGOUT",f="FETCH_BRANCHES",h="ERROR",v=n(8),O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{authData:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return localStorage.setItem("profile",JSON.stringify(Object(v.a)({},null===t||void 0===t?void 0:t.payload))),Object(v.a)(Object(v.a)({},e),{},{authData:t.payload});case p:return localStorage.clear(),{authData:null,alerts:null,branches:null};default:return e}},m=Object(o.b)({alerts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return t.payload;case u:return[].concat(Object(l.a)(e),[t.payload]);case d:return e.map((function(e){return e._id===t.payload._id?t.payload:e}));default:return e}},auth:O,branch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return t.payload;default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return t.payload;default:return e}}}),x=n(4),g=n.n(x),N=n(12),y=n(7),w=n(66),k=n.n(w).a.create({baseURL:"https://scavangerhunt.herokuapp.com/"});k.interceptors.request.use((function(e){return localStorage.getItem("profile")&&(e.headers.Authorization="Bearer ".concat(JSON.parse(localStorage.getItem("profile")).token)),e}));var S=function(e){return k.get("/alerts/match",{params:{pincodes:e}})},E=function(e,t){return k.patch("/alerts/".concat(e),{branchId:t})},C=function(e){return k.post("/branches/signin",e)},D=function(e){return k.get("/branches/".concat(e.pincode))},I=function(e,t){return function(){var n=Object(N.a)(g.a.mark((function n(a){var c,r;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,C(e);case 3:c=n.sent,(r=c.data).error?(console.log("else",r),a({type:h,payload:r})):(console.log(r),a({type:j,payload:r}),t.push("/")),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("Error"),console.log(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()},A=function(e){return function(){var t=Object(N.a)(g.a.mark((function t(n){var a,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D(e);case 3:a=t.sent,c=a.data,n({type:f,payload:c}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},B=n(3),H=n(1),L=function(){var e=Object(a.useState)({branchName:"",password:""}),t=Object(y.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(""),o=Object(y.a)(r,2),i=o[0],l=o[1],u=Object(s.b)(),d=Object(B.f)(),b=Object(s.c)((function(e){return e.error.error?e.error.error:""}));Object(a.useEffect)((function(){b&&l(b)}),[b]);var j=function(){var e=Object(N.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l(""),t.preventDefault(),""!==n.branchName){e.next=5;break}return l("Please enter Branch name"),e.abrupt("return");case 5:if(""!==n.password){e.next=8;break}return l("Please enter password"),e.abrupt("return");case 8:u(I(n,d));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{className:"login",children:[Object(H.jsx)("h2",{className:"loginHeader",children:" Login"}),Object(H.jsxs)("form",{onSubmit:j,children:[Object(H.jsxs)("div",{className:"mb-3",children:[Object(H.jsx)("label",{className:"form-label",children:"Branch"}),Object(H.jsx)("input",{type:"text",className:"form-control",id:"branchName",onChange:function(e){return c(Object(v.a)(Object(v.a)({},n),{},{branchName:e.target.value}))}})]}),Object(H.jsxs)("div",{className:"mb-3",children:[Object(H.jsx)("label",{className:"form-label",children:"Password"}),Object(H.jsx)("input",{type:"password",className:"form-control",id:"password",onChange:function(e){return c(Object(v.a)(Object(v.a)({},n),{},{password:e.target.value}))}})]}),Object(H.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Login"}),Object(H.jsx)("label",{children:i})]})]})},P=function(){return function(){var e=Object(N.a)(g.a.mark((function e(t){var n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.get("/alerts");case 3:n=e.sent,a=n.data,t({type:b,payload:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},_=function(e){return function(){var t=Object(N.a)(g.a.mark((function t(n){var a,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S(e);case 3:a=t.sent,c=a.data,n({type:b,payload:c}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},J=function(e,t){return function(){var n=Object(N.a)(g.a.mark((function n(a){var c,r;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,s=e,k.post("/alerts",s);case 3:c=n.sent,r=c.data,t.emit("newHunt",r),a({type:u,payload:r}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0.message);case 12:case"end":return n.stop()}var s}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},R=n(32),T=n.n(R),U=function(){var e=Object(a.useState)({contactDetails:"",pincode:""}),t=Object(y.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)([]),o=Object(y.a)(r,2),i=o[0],l=o[1],u=Object(a.useState)(""),d=Object(y.a)(u,2),b=d[0],j=d[1],p=Object(s.b)(),f=Object(s.c)((function(e){return e.branch})),h=T.a.connect("https://scavangerhunt.herokuapp.com/",{transports:["websocket","polling","flashsocket"]});Object(a.useEffect)((function(){f&&l(f)}),[f]);var O=function(){var e=Object(N.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j(""),t.preventDefault(),""!==n.contactDetails){e.next=5;break}return j("Please enter Contact Details"),e.abrupt("return");case 5:if(""!==n.pincode){e.next=8;break}return j("Please enter Pincode"),e.abrupt("return");case 8:p(A(n)),p(J(n,h));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{className:"row",children:[Object(H.jsxs)("div",{className:"login col-5",children:[Object(H.jsx)("h2",{className:"loginHeader",children:" Go for Hunt..."}),Object(H.jsxs)("form",{onSubmit:O,children:[Object(H.jsxs)("div",{className:"mb-3",children:[Object(H.jsx)("label",{className:"form-label",children:"Contact Details"}),Object(H.jsx)("input",{type:"text",className:"form-control",id:"contactDetails",onChange:function(e){return c(Object(v.a)(Object(v.a)({},n),{},{contactDetails:e.target.value}))}})]}),Object(H.jsxs)("div",{className:"mb-3",children:[Object(H.jsx)("label",{className:"form-label",children:"Pincode"}),Object(H.jsx)("input",{type:"text",className:"form-control",id:"pincode",onChange:function(e){return c(Object(v.a)(Object(v.a)({},n),{},{pincode:e.target.value}))}})]}),Object(H.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Search"}),Object(H.jsx)("label",{children:b})]})]}),Object(H.jsx)("div",{className:"col-1"}),Object(H.jsx)("ul",{className:"list-group col-6",children:i.map((function(e){return Object(H.jsxs)("li",{href:"#",className:"list-group-item",children:[Object(H.jsxs)("div",{children:["Branch Name : ",e.branchName]}),Object(H.jsxs)("div",{children:["Branch Incharge : ",e.branchIncharge]}),Object(H.jsxs)("div",{children:["Branch Address : ",e.address,", ",e.city]}),Object(H.jsxs)("div",{children:["Contact No. : ",e.contactNumber]})]},e.branchName)}))})]})},G=n(19),F=function(){var e=Object(a.useState)(JSON.parse(localStorage.getItem("profile"))),t=Object(y.a)(e,2),n=t[0],c=t[1],r=Object(s.b)(),o=Object(B.f)(),i=Object(B.g)(),l=Object(s.c)((function(e){return e.alerts})),u=T.a.connect("https://scavangerhunt.herokuapp.com/",{transports:["websocket","polling","flashsocket"]});Object(a.useEffect)((function(){return u.on("updateNotification",(function(e){var t;if(console.log("Notification Received"),"Admin"===(null===n||void 0===n||null===(t=n.result)||void 0===t?void 0:t.branchName))r(P());else if(null===n||void 0===n?void 0:n.result){var a;r(_(null===n||void 0===n||null===(a=n.result)||void 0===a?void 0:a.pincodes))}})),function(){return u.disconnect()}}),[]),Object(a.useEffect)((function(){var e;if("Admin"===(null===n||void 0===n||null===(e=n.result)||void 0===e?void 0:e.branchName))r(P());else if(null===n||void 0===n?void 0:n.result){var t;r(_(null===n||void 0===n||null===(t=n.result)||void 0===t?void 0:t.pincodes))}}),[n]),Object(a.useEffect)((function(){c(JSON.parse(localStorage.getItem("profile")))}),[i]);return Object(H.jsxs)("div",{className:"row navbar",children:[Object(H.jsx)("h2",{className:"col-9 heading",children:Object(H.jsx)(G.b,{to:"/",children:"Scavanger Hunt"})}),Object(H.jsx)("div",{className:"col-3 user",children:n?Object(H.jsxs)("div",{className:"row align-items-center",children:[Object(H.jsxs)("div",{className:"profile col-8",children:[Object(H.jsxs)(G.b,{to:"/notifications",children:[Object(H.jsx)("span",{className:"avatar"}),Object(H.jsx)("span",{className:"badge badge-light",children:function(){var e;if(null===n||void 0===n||null===(e=n.result)||void 0===e?void 0:e._id)return l.filter((function(e){var t;return!e.viewedBy.includes(null===n||void 0===n||null===(t=n.result)||void 0===t?void 0:t._id)})).length}()})]}),Object(H.jsx)("span",{className:"branchname",children:n.result.branchName})]}),Object(H.jsx)("div",{className:"col-4",children:Object(H.jsx)("button",{onClick:function(){r({type:p}),o.push("/"),c(null)},className:"btn btn-primary btn-sm",children:"Logout"})})]}):Object(H.jsx)(G.b,{to:"/login",className:"btn btn-primary btn-sm",children:"Login"})})]})},q=n(67),z=n.n(q),K=function(e){var t=e.item,n=e.branchId,c=Object(s.b)(),r=Object(a.useState)(t.viewedBy.includes(n)),o=Object(y.a)(r,2),i=o[0],l=o[1];return Object(H.jsxs)("a",{href:"#",className:"list-group-item ".concat(i?"viewed":"notviewed"),onClick:function(){i||(c(function(e,t){return function(){var n=Object(N.a)(g.a.mark((function n(a){var c,r;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,E(e,t);case 3:c=n.sent,r=c.data,a({type:d,payload:r}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0.message);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}(t._id,n)),l(!0))},children:[Object(H.jsxs)("div",{children:["Contact Details : ",t.contactDetails]}),Object(H.jsxs)("div",{children:["Pincode: ",t.pincode]}),Object(H.jsxs)("div",{className:"timestamp",children:[" ",z()(t.createdAt).format("lll")]})]})},M=function(){var e=Object(a.useState)([]),t=Object(y.a)(e,2),n=t[0],c=t[1],r=Object(s.b)(),o=Object(s.c)((function(e){return e.alerts})),i=Object(a.useState)(JSON.parse(localStorage.getItem("profile"))),l=Object(y.a)(i,2),u=l[0],d=l[1];return Object(a.useEffect)((function(){o&&c(o)}),[o]),Object(a.useEffect)((function(){var e,t;(d(JSON.parse(localStorage.getItem("profile"))),"Admin"===(null===u||void 0===u||null===(e=u.result)||void 0===e?void 0:e.branchName))?r(P()):r(_(null===u||void 0===u||null===(t=u.result)||void 0===t?void 0:t.pincodes))}),[]),Object(H.jsx)("div",{className:"row",children:Object(H.jsx)("div",{className:"list-group",children:n.map((function(e){var t;return Object(H.jsx)(K,{item:e,branchId:null===(t=u.result)||void 0===t?void 0:t._id},e._id)}))})})},Q=function(){return Object(H.jsxs)(G.a,{children:[Object(H.jsx)(F,{}),Object(H.jsx)("div",{className:"container",children:Object(H.jsxs)(B.c,{children:[Object(H.jsx)(B.a,{path:"/",exact:!0,component:U}),Object(H.jsx)(B.a,{path:"/login",exact:!0,component:L}),Object(H.jsx)(B.a,{path:"/notifications",exact:!0,component:M})]})})]})},V=(n(126),Object(o.d)((function(e,t){return"LOGOUT"===t.type?m(void 0,t):m(e,t)}),Object(o.c)(Object(o.a)(i.a))));r.a.render(Object(H.jsx)(s.a,{store:V,children:Object(H.jsx)(Q,{})}),document.getElementById("root"))}},[[127,1,2]]]);
//# sourceMappingURL=main.0eef4fd4.chunk.js.map